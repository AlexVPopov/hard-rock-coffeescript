<!DOCTYPE HTML>
<html lang="en-US">
    <head prefix="og: http://ogp.me/ns# book: http://ogp.me/ns/book#">
        
        <meta charset="UTF-8">
        <title>Mixins and Extending classes | </title>

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="robots" content="index, follow">
        <meta name="author" content="alchapone">
        <meta name="description" content="![Hard Rock Coffeescript](assets/hard_rock.jpg)">
        <meta name="keywords" content="gitbook,github" >
        <meta name="generator" content="www.gitbook.io">

        
        
        <link rel="prev" href="../classes/instance_and_static_properties.html" />
        

        <meta property="og:title" content="Mixins and Extending classes | ">
        <meta property="og:site_name" content="">
        <meta property="og:type" content="book">
        <meta property="og:locale" content="en_US">

        <meta property="book:author" content="https://github.com/alchapone">
        <meta property="book:tag" content="GitBook">

        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">

        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    </head>
    <body>
        
        <link rel="stylesheet" href="../gitbook/style.css">
        
        
    <div class="book" data-github="alchapone/hard-rock-coffeescript" data-level="3.3" data-basepath=".." data-revision="1399053048546">
    <div class="book-header">
    <!-- Actions Left -->
    
    <a href="https://github.com/alchapone/hard-rock-coffeescript" target="_blank" class="btn pull-left"><i class="fa fa-github-alt"></i></a>
    
    <a href="#" class="btn pull-left toggle-summary"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search"><i class="fa fa-search"></i></a>

    <!-- Actions Right -->
    <a href="#" target="_blank" class="btn pull-right" data-sharing="google-plus"><i class="fa fa-google-plus"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="facebook"><i class="fa fa-facebook"></i></a>
    <a href="#" target="_blank" class="btn pull-right" data-sharing="twitter"><i class="fa fa-twitter"></i></a>

    
    <a href="https://github.com/alchapone/hard-rock-coffeescript/stargazers" target="_blank" class="btn pull-right count-star"><i class="fa fa-star-o"></i> Star (<span>-</span>)</a>
    <a href="https://github.com/alchapone/hard-rock-coffeescript/watchers" target="_blank" class="btn pull-right count-watch"><i class="fa fa-eye"></i> Watch (<span>-</span>)</a>
    

    <!-- Title -->
    <h1><a href="../" ></a></h1>
</div>

    <div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Search" class="form-control" />
    </div>
    <ul class="summary">
        
        <li>
            <a href="https://github.com/alchapone" target="blank">About the author</a>
        </li>
        <li>
            <a href="https://github.com/alchapone/hard-rock-coffeescript/issues" target="blank">Questions and Issues</a>
        </li>
        <li>
            <a href="https://github.com/alchapone/hard-rock-coffeescript/edit/master/classes/extending_classes.md" target="blank">Edit and Contribute</a>
        </li>
        <li class="divider"></li>
        
        <li data-level="0" data-path="index.html">
            <a href="../"><i class="fa fa-check"></i> Introduction</a>
        </li>
        
            <li  data-level="1" data-path="installation/index.html">
                
                <a href="../installation/index.html">
                    <i class="fa fa-check"></i> <b>1.</b> Installation
                </a>
                
                
            </li>
        
            <li  data-level="2" data-path="syntax/scoping.html">
                
                <a href="../syntax/scoping.html">
                    <i class="fa fa-check"></i> <b>2.</b> Syntax
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="2.1" data-path="syntax/variables.html">
                            
                            <a href="../syntax/variables.html">
                                <i class="fa fa-check"></i> <b>2.1.</b> Variables and Scope
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.2" data-path="syntax/functions.html">
                            
                            <a href="../syntax/functions.html">
                                <i class="fa fa-check"></i> <b>2.2.</b> Functions
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.3" data-path="syntax/flow_control.html">
                            
                            <a href="../syntax/flow_control.html">
                                <i class="fa fa-check"></i> <b>2.3.</b> Flow control
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.4" data-path="syntax/arrays_and_objects.html">
                            
                            <a href="../syntax/arrays_and_objects.html">
                                <i class="fa fa-check"></i> <b>2.4.</b> Arrays and objects
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.5" data-path="syntax/operators_and_alises.html">
                            
                            <a href="../syntax/operators_and_alises.html">
                                <i class="fa fa-check"></i> <b>2.5.</b> Operators and Aliases
                            </a>
                            
                        </li>
                    
                        <li  data-level="2.6" data-path="syntax/loops_and_comprehensions.html">
                            
                            <a href="../syntax/loops_and_comprehensions.html">
                                <i class="fa fa-check"></i> <b>2.6.</b> Loops and comprehensions
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
            <li  data-level="3" data-path="classes/index.html">
                
                <a href="../classes/index.html">
                    <i class="fa fa-check"></i> <b>3.</b> Classes
                </a>
                
                
                <ul class="articles">
                    
                        <li  data-level="3.1" data-path="classes/inheritance.html">
                            
                            <a href="../classes/inheritance.html">
                                <i class="fa fa-check"></i> <b>3.1.</b> Inheritance &amp; Super
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.2" data-path="classes/instance_and_static_properties.html">
                            
                            <a href="../classes/instance_and_static_properties.html">
                                <i class="fa fa-check"></i> <b>3.2.</b> Instance &amp; Static properties
                            </a>
                            
                        </li>
                    
                        <li  data-level="3.3" data-path="classes/extending_classes.html">
                            
                            <a href="../classes/extending_classes.html">
                                <i class="fa fa-check"></i> <b>3.3.</b> Mixins and Extending classes
                            </a>
                            
                        </li>
                    
                </ul>
                
            </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="page-wrapper" tabindex="-1">
                <div class="book-progress">
    <div class="bar">
        <div class="inner" style="width: 100%;min-width: 91.66666666666667%;"></div>
    </div>
    <div class="chapters">
    
        <a href="../index.html" title="Introduction" class="chapter done new-chapter" data-progress="0" style="left: 0%;"></a>
    
        <a href="../installation/index.html" title="Installation" class="chapter done new-chapter" data-progress="1" style="left: 8.333333333333334%;"></a>
    
        <a href="../syntax/scoping.html" title="Syntax" class="chapter done new-chapter" data-progress="2" style="left: 16.666666666666668%;"></a>
    
        <a href="../syntax/variables.html" title="Variables and Scope" class="chapter done " data-progress="2.1" style="left: 25%;"></a>
    
        <a href="../syntax/functions.html" title="Functions" class="chapter done " data-progress="2.2" style="left: 33.333333333333336%;"></a>
    
        <a href="../syntax/flow_control.html" title="Flow control" class="chapter done " data-progress="2.3" style="left: 41.666666666666664%;"></a>
    
        <a href="../syntax/arrays_and_objects.html" title="Arrays and objects" class="chapter done " data-progress="2.4" style="left: 50%;"></a>
    
        <a href="../syntax/operators_and_alises.html" title="Operators and Aliases" class="chapter done " data-progress="2.5" style="left: 58.333333333333336%;"></a>
    
        <a href="../syntax/loops_and_comprehensions.html" title="Loops and comprehensions" class="chapter done " data-progress="2.6" style="left: 66.66666666666667%;"></a>
    
        <a href="../classes/index.html" title="Classes" class="chapter done new-chapter" data-progress="3" style="left: 75%;"></a>
    
        <a href="../classes/inheritance.html" title="Inheritance &amp; Super" class="chapter done " data-progress="3.1" style="left: 83.33333333333333%;"></a>
    
        <a href="../classes/instance_and_static_properties.html" title="Instance &amp; Static properties" class="chapter done " data-progress="3.2" style="left: 91.66666666666667%;"></a>
    
        <a href="../classes/extending_classes.html" title="Mixins and Extending classes" class="chapter done " data-progress="3.3" style="left: 100%;"></a>
    
    </div>
</div>

                <div class="page-inner">
                
                    <section class="normal" id="section-gitbook_2">
                    
                        <h2 id="mixins-and-extending-classes">Mixins and Extending classes</h2>
<p>Mixins are not something supported natively by CoffeeScript, for the good reason that they can be trivially implemented yourself. For example, here&#39;s two functions, <code>extend()</code> and <code>include()</code> that&#39;ll add class and instance properties respectively to a class.</p>
<p><em>CoffeeScript</em></p>
<pre><code class="lang-coffeescript"><span class="hljs-function"><span class="hljs-title">extend</span> = <span class="hljs-params">(obj, mixin)</span> -&gt;</span>
  obj[name] = method <span class="hljs-keyword">for</span> name, method <span class="hljs-keyword">of</span> mixin
  obj

<span class="hljs-function"><span class="hljs-title">include</span> = <span class="hljs-params">(klass, mixin)</span> -&gt;</span>
  extend klass.prototype, mixin

<span class="hljs-comment"># Usage</span>
include Guitar,
  <span class="hljs-attribute">strings</span>: <span class="hljs-literal">true</span>
guitar = <span class="hljs-keyword">new</span> Guitar()
guitar.strings
</code></pre>
<p><em>JavaScript</em></p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> extend, guitar, include;
extend = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj, mixin)</span> {</span>
  <span class="hljs-keyword">var</span> method, name;
  <span class="hljs-keyword">for</span> (name <span class="hljs-keyword">in</span> mixin) {
    method = mixin[name];
    obj[name] = method;
  }
  <span class="hljs-keyword">return</span> obj;
};
include = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(klass, mixin)</span> {</span>
  <span class="hljs-keyword">return</span> extend(klass.prototype, mixin);
};
include(Guitar, {
  strings: <span class="hljs-literal">true</span>
});
guitar = <span class="hljs-keyword">new</span> Guitar();
guitar.strings;
</code></pre>
<p>Mixins are a great pattern for sharing common logic between modules when inheritance is not suited. The advantage of mixins, is that you can include multiple ones, compared to inheritance where only one class can be inherited from.</p>
<h2 id="extending-classes">Extending classes</h2>
<p>Mixins are pretty neat, but they&#39;re not very object orientated. Instead, let&#39;s integrate mixins into CoffeeScript&#39;s classes. We&#39;re going to define a class called <code>Module</code> that we can inherit from for mixin support. Module will have two static functions, <code>@extend()</code> and <code>@include()</code> which we can use for extending the class with static and instance properties respectively.</p>
<p><em>CoffeeScript</em></p>
<pre><code class="lang-coffeescript">moduleKeywords = [<span class="hljs-string">'extended'</span>, <span class="hljs-string">'included'</span>]

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Module</span></span>
  <span class="hljs-property">@extend</span>: <span class="hljs-function"><span class="hljs-params">(obj)</span> -&gt;</span>
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">of</span> obj <span class="hljs-keyword">when</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> moduleKeywords
      @[key] = value
    obj.extended?.apply(@)
    @

  <span class="hljs-property">@include</span>: <span class="hljs-function"><span class="hljs-params">(obj)</span> -&gt;</span>
    <span class="hljs-keyword">for</span> key, value <span class="hljs-keyword">of</span> obj <span class="hljs-keyword">when</span> key <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> moduleKeywords
      @::[key] = value
    obj.included?.apply(@)
    @
</code></pre>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> Module, moduleKeywords,
  __indexOf = [].indexOf || <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span> {</span> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = <span class="hljs-keyword">this</span>.length; i &lt; l; i++) { <span class="hljs-keyword">if</span> (i <span class="hljs-keyword">in</span> <span class="hljs-keyword">this</span> &amp;&amp; <span class="hljs-keyword">this</span>[i] === item) <span class="hljs-keyword">return</span> i; } <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>; };
moduleKeywords = [<span class="hljs-string">'extended'</span>, <span class="hljs-string">'included'</span>];
Module = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Module</span><span class="hljs-params">()</span> {</span>}
  Module.extend = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> {</span>
    <span class="hljs-keyword">var</span> key, value, _ref;
    <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
      value = obj[key];
      <span class="hljs-keyword">if</span> (__indexOf.call(moduleKeywords, key) &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>[key] = value;
      }
    }
    <span class="hljs-keyword">if</span> ((_ref = obj.extended) != <span class="hljs-literal">null</span>) {
      _ref.apply(<span class="hljs-keyword">this</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  };

  Module.include = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(obj)</span> {</span>
    <span class="hljs-keyword">var</span> key, value, _ref;
    <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> obj) {
      value = obj[key];
      <span class="hljs-keyword">if</span> (__indexOf.call(moduleKeywords, key) &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">this</span>.prototype[key] = value;
      }
    }
    <span class="hljs-keyword">if</span> ((_ref = obj.included) != <span class="hljs-literal">null</span>) {
      _ref.apply(<span class="hljs-keyword">this</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
  };
  <span class="hljs-keyword">return</span> Module;
})();
</code></pre>
<p>The little dance around the moduleKeywords variable is to ensure we have callback support when mixins extend a class. Let&#39;s take a look at our Module class in action:</p>
<p><em>CoffeeSscript</em></p>
<pre><code class="lang-coffeescript">classProperties =
  <span class="hljs-attribute">tuning</span>:<span class="hljs-function"> -&gt;</span>

instanceProperties =
  <span class="hljs-attribute">makeSound</span>:<span class="hljs-function"> -&gt;</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Guitar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span></span>
  <span class="hljs-property">@extend</span> classProperties
  <span class="hljs-property">@include</span> instanceProperties

Guitar.tuning()

guitar = <span class="hljs-keyword">new</span> Guitar()
guitar.makeSound()
</code></pre>
<p><em>JavaScript</em></p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> Guitar, classProperties, guitar, instanceProperties,
  __hasProp = {}.hasOwnProperty,
  __extends = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(child, parent)</span> {</span> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> parent) { <span class="hljs-keyword">if</span> (__hasProp.call(parent, key)) child[key] = parent[key]; } <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ctor</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.constructor = child; } ctor.prototype = parent.prototype; child.prototype = <span class="hljs-keyword">new</span> ctor(); child.__super__ = parent.prototype; <span class="hljs-keyword">return</span> child; };
classProperties = {
  tuning: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>}
};
instanceProperties = {
  makeSound: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>}
};
Guitar = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(_super)</span> {</span>
  __extends(Guitar, _super);
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Guitar</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">return</span> Guitar.__super__.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  }
  Guitar.extend(classProperties);
  Guitar.include(instanceProperties);
  <span class="hljs-keyword">return</span> Guitar;
})(Module);

Guitar.tuning();
guitar = <span class="hljs-keyword">new</span> Guitar();
guitar.makeSound();
</code></pre>
<p>So above we&#39;ve added static property <code>tuning()</code> to the <code>Guitar</code> class, as well as an instance
property, <code>makeSound()</code>. Since we&#39;ve got callbacks whenever modules are extended, we can shortcut the process of applying
both static and instance properties:</p>
<p><em>CoffeeScript</em></p>
<pre><code class="lang-coffeescript">SOUND =
  <span class="hljs-attribute">tuning</span>:<span class="hljs-function"> -&gt;</span>
  <span class="hljs-attribute">extended</span>:<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@include</span>
      <span class="hljs-attribute">makeSound</span>:<span class="hljs-function"> -&gt;</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Guitar</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Module</span></span>
  <span class="hljs-property">@extend</span> SOUND
</code></pre>
<p><em>JavaScript</em></p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> Guitar, SOUND,
  __hasProp = {}.hasOwnProperty,
  __extends = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(child, parent)</span> {</span> <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> key <span class="hljs-keyword">in</span> parent) { <span class="hljs-keyword">if</span> (__hasProp.call(parent, key)) child[key] = parent[key]; } <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ctor</span><span class="hljs-params">()</span> {</span> <span class="hljs-keyword">this</span>.constructor = child; } ctor.prototype = parent.prototype; child.prototype = <span class="hljs-keyword">new</span> ctor(); child.__super__ = parent.prototype; <span class="hljs-keyword">return</span> child; };

SOUND = {
  tuning: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>},
  extended: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.include({
      makeSound: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> {</span>}
    });
  }
};

Guitar = (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(_super)</span> {</span>
  __extends(Guitar, _super);
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Guitar</span><span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">return</span> Guitar.__super__.constructor.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
  }
  Guitar.extend(SOUND);
  <span class="hljs-keyword">return</span> Guitar;
})(Module);
</code></pre>

                    
                    </section>
                
                </div>
            </div>
        </div>

        
        <a href="../classes/instance_and_static_properties.html" class="navigation navigation-prev"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
        <script type="text/javascript">(function(e,b){if(!b.__SV){var a,f,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=e.createElement("script");a.type="text/javascript";a.async=!0;a.src=("https:"===e.location.protocol?"https:":"http:")+'//cdn.mxpnl.com/libs/mixpanel-2.2.min.js';f=e.getElementsByTagName("script")[0];f.parentNode.insertBefore(a,f)}})(document,window.mixpanel||[]);
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/mode-javascript.js"></script>
        <script src="../gitbook/jsrepl/jsrepl.js" id="jsrepl-script"></script>
        <script src="../gitbook/app.js"></script>
        
    </body>
</html>
